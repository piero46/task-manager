- name: Build All (including APK if possible)
  run: |
    export ANDROID_NDK_ROOT=$ANDROID_HOME/ndk/25.2.9519653

    # ⭐️ Проверяем переменные
    echo "QT_PATH: $QT_PATH"
    echo "QT_ANDROID_PATH: $QT_PATH/6.8.0/android_arm64_v8a"

    # ⭐️ Убеждаемся, что путь существует
    if [ ! -d "$QT_PATH/6.8.0/android_arm64_v8a" ]; then
      echo "❌ Android Qt not found at $QT_PATH/6.8.0/android_arm64_v8a"
      exit 1
    fi

    # Устанавливаем путь к Android Qt
    export QT_ANDROID_PATH=$QT_PATH/6.8.0/android_arm64_v8a

    # Проверяем наличие toolchain файла
    if [ ! -f "$QT_ANDROID_PATH/lib/cmake/Qt6/qt.toolchain.cmake" ]; then
      echo "❌ qt.toolchain.cmake not found!"
      ls -la $QT_ANDROID_PATH/lib/cmake/Qt6/
      exit 1
    fi

    cmake -B build -G Ninja \
      -DCMAKE_TOOLCHAIN_FILE=$QT_ANDROID_PATH/lib/cmake/Qt6/qt.toolchain.cmake \
      -DANDROID_ABI=arm64-v8a \
      -DQT_ANDROID_PLATFORM_LEVEL=33 \
      -DANDROID=TRUE

    cmake --build build --target all